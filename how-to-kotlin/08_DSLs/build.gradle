plugins {
    id "checkstyle"
    id "java"
    id "org.jetbrains.kotlin.jvm" version "$kotlinVersion"
}

group "$appGroup"
version "$appVersion"

description = """Kotlin/JVM code example"""

sourceSets {
    // Default: srcDirs "src/main/kotlin"
	main.kotlin.srcDirs "src/main/kotlin"
}
// Default: buildDir = "build"
buildDir = "target"

ext {
    ktLintOpts = [
        "--reporter=plain",
        "--reporter=checkstyle,output=$buildDir\\ktlint-report.xml"
    ]
}

task lint(type: JavaExec) {
    description "Analyze Kotlin source files with KtLint"
    main "-jar"
    args files("$ktLintJar") + ktLintOpts + sourceSets.main.allSource.files
}

checkstyle {
    maxErrors = 10
}

java {
    sourceCompatibility = JavaVersion.VERSION_1_8
    targetCompatibility = JavaVersion.VERSION_1_8
}

compileKotlin {
    // dependsOn lint

    kotlinOptions {
        // Tool options
        // suppressWarnings = true
        // verbose = false
        // Common options
        apiVersion = "1.3"
        languageVersion = "1.3"
        // JVM options
        jvmTarget = "1.8"
    }
}

task run(type: JavaExec) {
    dependsOn compileKotlin
    description "Execute Kotlin main class $mainClassName"
    classpath sourceSets.main.runtimeClasspath
    main mainClassName
    args ""
}

repositories {
    mavenCentral()
}

dependencies {
    implementation "org.jetbrains.kotlin:kotlin-stdlib:$kotlinVersion"
    // testCompile "junit:junit:4.12"
}
